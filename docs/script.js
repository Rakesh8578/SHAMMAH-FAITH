/* =========================
   SONG DATA (WITH YOUTUBE)
   ========================= */

const songs = {
  1: {
    lyrics: `‡∞§‡∞æ‡∞∞ ‡∞µ‡±Ü‡∞≤‡∞ø‡∞∏‡∞ø‡∞Ç‡∞¶‡∞ø ‡∞Ü ‡∞®‡∞ø‡∞Ç‡∞ó‡∞ø‡∞≤‡±ã ‡∞ß‡∞∞‡∞£‡∞ø ‡∞Æ‡±Å‡∞∞‡∞ø‡∞∏‡∞ø‡∞Ç‡∞¶‡∞ø
‡∞¶‡±Ç‡∞§ ‡∞µ‡∞ö‡±ç‡∞ö‡∞ø‡∞Ç‡∞¶‡∞ø ‡∞∏‡±Å‡∞µ‡∞æ‡∞∞‡±ç‡∞§‡∞®‡±Å ‡∞Æ‡∞æ‡∞ï‡±Å ‡∞§‡±Ü‡∞≤‡∞ø‡∞™‡∞ø‡∞Ç‡∞¶‡∞ø (2)

‡∞∞‡∞æ‡∞ú‡±Å‡∞≤‡∞ï‡±Å ‡∞∞‡∞æ‡∞ú‡±Å ‡∞™‡±Å‡∞ü‡±ç‡∞ü‡∞æ‡∞°‡∞®‡∞ø
‡∞Ø‡±Ç‡∞¶‡±Å‡∞≤ ‡∞∞‡∞æ‡∞ú‡±Å ‡∞â‡∞¶‡∞Ø‡∞ø‡∞Ç‡∞ö‡∞æ‡∞°‡∞®‡∞ø (2)         ||‡∞§‡∞æ‡∞∞||

‡∞Æ‡∞Ç‡∞¶‡∞®‡±Å ‡∞µ‡∞ø‡∞°‡∞ö‡∞ø ‡∞Æ‡∞Æ‡±ç‡∞Æ‡±Å‡∞®‡±Å ‡∞Æ‡∞∞‡∞ö‡∞ø
‡∞Æ‡±á‡∞Æ‡∞Ç‡∞§‡∞æ ‡∞ï‡∞≤‡∞ø‡∞∏‡∞ø ‡∞µ‡±Ü‡∞≥‡±ç‡∞≥‡∞æ‡∞Æ‡±Å‡∞≤‡±á
‡∞Ü ‡∞ä‡∞∞‡∞ø‡∞≤‡±ã ‡∞Ü ‡∞™‡∞æ‡∞ï‡∞≤‡±ã
‡∞∏‡±ç‡∞§‡±Å‡∞§‡∞ø ‡∞ó‡∞æ‡∞®‡∞æ‡∞≤‡±Å ‡∞™‡∞æ‡∞°‡∞æ‡∞Æ‡±Å‡∞≤‡±á (2)

‡∞∏‡∞Ç‡∞§‡±ã‡∞∑‡∞Æ‡±á ‡∞á‡∞ï ‡∞∏‡∞Ç‡∞¨‡∞∞‡∞Æ‡±á
‡∞≤‡±ã‡∞ï ‡∞∞‡∞ï‡±ç‡∞∑‡∞£ ‡∞Ü‡∞®‡∞Ç‡∞¶‡∞Æ‡±á
‡∞∏‡±ç‡∞§‡±ã‡∞§‡±ç‡∞∞‡∞æ‡∞∞‡±ç‡∞™‡∞£‡±á ‡∞Æ‡∞æ ‡∞∞‡∞æ‡∞∞‡∞æ‡∞ú‡±Å‡∞ï‡±á
‡∞á‡∞¶‡∞ø ‡∞ï‡±ç‡∞∞‡∞ø‡∞∏‡±ç‡∞Æ‡∞∏‡±ç ‡∞Ü‡∞∞‡±ç‡∞≠‡∞æ‡∞ü‡∞Æ‡±á         ||‡∞§‡∞æ‡∞∞||

‡∞¨‡∞Ç‡∞ó‡∞æ‡∞∞‡∞Æ‡±Å‡∞®‡±Å ‡∞∏‡∞æ‡∞Ç‡∞¨‡±ç‡∞∞‡∞æ‡∞£‡∞ø‡∞Ø‡±Å
‡∞¨‡±ã‡∞≥‡∞Ç‡∞¨‡±Å‡∞®‡±Å ‡∞§‡±Ü‡∞ö‡±ç‡∞ö‡∞æ‡∞Æ‡±Å‡∞≤‡±á
‡∞Ü ‡∞Ø‡∞ø‡∞Ç‡∞ü‡∞ø‡∞≤‡±ã ‡∞Æ‡∞æ ‡∞ï‡∞Ç‡∞ü‡∞ø‡∞§‡±ã
‡∞®‡∞ø‡∞®‡±Å ‡∞ï‡∞®‡±Å‡∞≤‡∞æ‡∞∞‡∞æ ‡∞ó‡∞æ‡∞Ç‡∞ö‡∞æ‡∞Æ‡±Å‡∞≤‡±á (2)

‡∞Æ‡∞æ ‡∞á‡∞Æ‡±ç‡∞Æ‡∞æ‡∞®‡±Å‡∞Ø‡±á‡∞≤‡±Å‡∞µ‡±Å ‡∞®‡±Ä‡∞µ‡±á‡∞®‡∞®‡∞ø
‡∞®‡∞ø‡∞®‡±Å ‡∞Æ‡∞®‡∞∏‡∞æ‡∞∞‡∞æ ‡∞ï‡±ä‡∞≤‡∞ø‡∞ö‡∞æ‡∞Æ‡±Å‡∞≤‡±á
‡∞Æ‡∞æ ‡∞Ø‡±Ç‡∞¶‡±Å‡∞≤ ‡∞∞‡∞æ‡∞ú‡±Å‡∞µ‡±Å ‡∞®‡±Ä‡∞µ‡±á‡∞®‡∞®‡∞ø
‡∞®‡∞ø‡∞®‡±Å ‡∞ò‡∞®‡∞™‡∞∞‡∞ö‡∞ø ‡∞™‡±ä‡∞ó‡∞ø‡∞°‡∞æ‡∞Æ‡±Å‡∞≤‡±á        ||‡∞§‡∞æ‡∞∞||`,
    youtube: "https://www.youtube.com/watch?v=dQw4w9WgXcQ"
  },

  2: {
    lyrics: `‡∞Ø‡±á‡∞∏‡∞Ø‡±ç‡∞Ø ‡∞®‡∞æ‡∞Æ‡∞Æ‡±Å‡∞≤‡±ã ‡∞∂‡∞ï‡±ç‡∞§‡∞ø ‡∞â‡∞Ç‡∞¶‡∞ø
‡∞Ø‡±á‡∞∏‡∞Ø‡±ç‡∞Ø ‡∞™‡±ç‡∞∞‡±á‡∞Æ‡∞≤‡±ã ‡∞∞‡∞ï‡±ç‡∞∑‡∞£ ‡∞â‡∞Ç‡∞¶‡∞ø`,
    youtube: "https://www.youtube.com/watch?v=dQw4w9WgXcQ"
  },

  3: {
    lyrics: `‡∞™‡±ç‡∞∞‡∞≠‡±Å‡∞µ‡∞æ ‡∞®‡±Ä ‡∞ï‡±É‡∞™ ‡∞Ö‡∞™‡∞æ‡∞∞‡∞Ç
‡∞®‡±Ä ‡∞™‡±ç‡∞∞‡±á‡∞Æ ‡∞∂‡∞æ‡∞∂‡±ç‡∞µ‡∞§‡∞Ç`,
    youtube: "https://www.youtube.com/watch?v=dQw4w9WgXcQ"
  }
};

/* =========================
   SHOW SONG
   ========================= */

function showSong(number) {
  const song = songs[number];
  if (!song) return;

  document.getElementById("lyrics").innerText = song.lyrics;

  // Show YouTube button
  const ytBtn = document.getElementById("youtubeBtn");
  if (ytBtn && song.youtube) {
    ytBtn.href = song.youtube;
    ytBtn.style.display = "inline-block";
  }

  history.pushState({ page: "song" }, "", "#song");
  localStorage.setItem("lastSong", number);
}

/* =========================
   SEARCH (TELUGU + ENGLISH)
   ========================= */

function searchSongs() {
  const input = document.getElementById("searchBox").value.toLowerCase();
  const buttons = document.querySelectorAll("#songButtons button");

  buttons.forEach(button => {
    const text =
      button.innerText.toLowerCase() + " " +
      button.getAttribute("data-search").toLowerCase();

    button.style.display = text.includes(input)
      ? "inline-block"
      : "none";
  });
}

/* =========================
   DOWNLOAD TXT
   ========================= */

function downloadLyrics() {
  const lyrics = document.getElementById("lyrics").innerText;

  if (!lyrics || lyrics.includes("‡∞™‡∞æ‡∞ü‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø")) {
    alert("Please select a song first");
    return;
  }

  const blob = new Blob([lyrics], { type: "text/plain;charset=utf-8" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "church-lyrics.txt";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

/* =========================
   DOWNLOAD PDF
   ========================= */

function downloadPDF() {
  const lyrics = document.getElementById("lyrics").innerText;

  if (!lyrics || lyrics.includes("‡∞™‡∞æ‡∞ü‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø")) {
    alert("Please select a song first");
    return;
  }

  const win = window.open("", "", "width=800,height=600");
  win.document.write("<pre style='font-size:16px;font-family:Arial;'>");
  win.document.write(lyrics.replace(/\n/g, "<br>"));
  win.document.write("</pre>");
  win.document.close();
  win.print();
}

/* =========================
   HOME (AUTO BACK)
   ========================= */

function goHomeAuto() {
  document.getElementById("lyrics").innerText = "‡∞™‡∞æ‡∞ü‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø üëÜ";
  localStorage.removeItem("lastSong");

  const ytBtn = document.getElementById("youtubeBtn");
  if (ytBtn) ytBtn.style.display = "none";

  const buttons = document.querySelectorAll("#songButtons button");
  buttons.forEach(btn => btn.style.display = "inline-block");
}

/* MOBILE / BROWSER BACK */
window.onpopstate = function () {
  goHomeAuto();
};

/* KEYBOARD ESC */
document.addEventListener("keydown", function (e) {
  if (e.key === "Escape") {
    goHomeAuto();
    history.pushState(null, "", "#home");
  }
});

/* RESTORE LAST SONG ON REFRESH */
window.onload = function () {
  const lastSongNumber = localStorage.getItem("lastSong");
  if (lastSongNumber && songs[lastSongNumber]) {
    showSong(lastSongNumber);
  }
};function searchSongs() {
  const input = document.getElementById("searchBox").value.toLowerCase();
  const buttons = document.querySelectorAll("#songButtons button");

  buttons.forEach(button => {
    const text =
      button.innerText.toLowerCase() + " " +
      button.getAttribute("data-search").toLowerCase();

    button.style.display = text.includes(input)
      ? "inline-block"
      : "none";
  });
}

/* DOWNLOAD TXT */
function downloadLyrics() {
  const lyrics = document.getElementById("lyrics").innerText;

  if (!lyrics || lyrics.includes("‡∞™‡∞æ‡∞ü‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø")) {
    alert("Please select a song first");
    return;
  }

  const blob = new Blob([lyrics], { type: "text/plain;charset=utf-8" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "church-lyrics.txt";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

/* DOWNLOAD PDF */
function downloadPDF() {
  const lyrics = document.getElementById("lyrics").innerText;

  if (!lyrics || lyrics.includes("‡∞™‡∞æ‡∞ü‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø")) {
    alert("Please select a song first");
    return;
  }

  const win = window.open("", "", "width=800,height=600");
  win.document.write("<pre style='font-size:16px;font-family:Arial;'>");
  win.document.write(lyrics.replace(/\n/g, "<br>"));
  win.document.write("</pre>");
  win.document.close();
  win.print();
}

/* HOME FUNCTION (AUTO) */
function goHomeAuto() {
  document.getElementById("lyrics").innerText = "‡∞™‡∞æ‡∞ü‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø üëÜ";
  localStorage.removeItem("lastSong");

  const buttons = document.querySelectorAll("#songButtons button");
  buttons.forEach(btn => btn.style.display = "inline-block");
}

/* MOBILE / BROWSER BACK */
window.onpopstate = function () {
  goHomeAuto();
};

/* KEYBOARD ESC */
document.addEventListener("keydown", function (e) {
  if (e.key === "Escape") {
    goHomeAuto();
    history.pushState(null, "", "#home");
  }
});

/* RESTORE LAST SONG ON REFRESH */
window.onload = function () {
  const savedLyrics = localStorage.getItem("lastSong");
  if (savedLyrics) {
    document.getElementById("lyrics").innerText = savedLyrics;
  }
};


